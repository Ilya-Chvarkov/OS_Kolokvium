name: CMake Build and Test

on: [push, pull_request]

jobs:
  build-and-test:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout repository
      uses: actions/checkout@v4

    - name: Install dependencies
      run: |
        sudo apt-get update
        sudo apt-get install -y cmake g++

    # Используем FetchContent из CMake вместо системного GTest
    - name: Build and Test Factorials
      working-directory: ./factorials-container
      run: |
        mkdir -p build && cd build
        cmake ..
        make
        ./FactorialsTest || exit 1

    - name: Build and Test RemoveDuplicates
      working-directory: ./remove-duplicates
      run: |
        mkdir -p build && cd build
        cmake ..
        make
        ./DuplicatesRemoverTest || exit 1

    - name: Build and Test ReverseLinkedList
      working-directory: ./reverse-linked-list
      run: |
        mkdir -p build && cd build
        cmake ..
        make
        ./LinkedListTest || exit 1
